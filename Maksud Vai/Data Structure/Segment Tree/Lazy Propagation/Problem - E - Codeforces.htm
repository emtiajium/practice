<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- saved from url=(0043)http://codeforces.com/contest/145/problem/E -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2"> 
    <title>Problem - E - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs">
    <meta name="robots" content="index, follow">
    <!--CombineResourcesFilter-->
    <link href="http://stat.codeforces.ru/favicon.png" rel="shortcut icon" type="image/png">
    <link href="./Problem - E - Codeforces_files/prettify.css" rel="stylesheet" type="text/css">
    <link charset="utf-8" href="./Problem - E - Codeforces_files/81d5459d81d074fc8d55b62d42856e2f_76f548702f55b8c8db24d49e11329d85.css" rel="stylesheet" type="text/css">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <link href="./Problem - E - Codeforces_files/style.css" rel="stylesheet" type="text/css">
    <link href="./Problem - E - Codeforces_files/style(1).css" rel="stylesheet" type="text/css">

    <script type="text/javascript" async="" src="./Problem - E - Codeforces_files/ga.js"></script><script charset="utf-8" src="./Problem - E - Codeforces_files/share.js" type="text/javascript"> </script>
    <link charset="utf-8" href="./Problem - E - Codeforces_files/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    <script src="./Problem - E - Codeforces_files/92a6f5c66e500b5c1433eae7d3f371bb_b4a14920cb66bc28c3f4ebdad0228f7b.js" type="text/javascript"> </script>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <!--/CombineResourcesFilter--></head>

<body><div id="cboxOverlay" style="display: none; "></div><div id="colorbox" class="" style="padding-bottom: 42px; padding-right: 42px; display: none; "><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left; "></div><div id="cboxTopCenter" style="float: left; "></div><div id="cboxTopRight" style="float: left; "></div></div><div><div id="cboxMiddleLeft" style="float: left; "></div><div id="cboxContent" style="float: left; "><div id="cboxLoadedContent" style="width: 0px; height: 0px; " class=""></div><div id="cboxLoadingOverlay" class=""></div><div id="cboxLoadingGraphic" class=""></div><div id="cboxTitle" class=""></div><div id="cboxCurrent" class=""></div><div id="cboxNext" class=""></div><div id="cboxPrevious" class=""></div><div id="cboxSlideshow" class=""></div><div id="cboxClose" class=""></div></div><div id="cboxMiddleRight" style="float: left; "></div></div><div><div id="cboxBottomLeft" style="float: left; "></div><div id="cboxBottomCenter" style="float: left; "></div><div id="cboxBottomRight" style="float: left; "></div></div></div><div style="position:absolute; width:9999px; visibility:hidden; display:none"></div></div>
<!-- Codeforces javascripts. -->

    <script type="text/javascript">
        $(document).ready(function() {
    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8" });
    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();

        var count = 0;

        function getDelay() {
            var delay = 0;
            var last = Codeforces.getCookie("lastOnlineTimeUpdaterInvocation");
            if (last && last != null) {
                var period = count < 20 ? 180 * 1000 : 360 * 1000;
                delay = period - (new Date().getTime() - last);
                if (delay < 0)
                    delay = 0;
            }
            return delay;
        }

        window.setInterval(function() {
            if (getDelay() <= 0 && count < 120) {
                count++;
                Codeforces.ping("/data/update-online");
            }
        }, 5000);

        var handle = "shibly";
        $("a.rated-user:contains(" + handle + ")").each(function() {
            if ($(this).text() == handle) {
                var td = $(this).parent();
                var tr = $(this).parent().parent();
                if (td.is("td") && tr.is("tr")) {
                    tr.addClass("highlighted-row");
                }
            }
        });

        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">

<div id="header" style="position:relative;">
    <div style="float:left;">
            <a href="http://codeforces.com/"><img src="./Problem - E - Codeforces_files/codeforces-logo-with-upper-beta.png"></a>
            <div style="position:absolute;left:147px;top:41px;">
                <a href="http://vk.com/" class="logo-href">Sponsored by <img style="position:relative;top:2px;" src="./Problem - E - Codeforces_files/vkontakte-tiny-en.png"></a>
            </div>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="http://codeforces.com/contest/145/problem/E?locale=en"><img src="./Problem - E - Codeforces_files/gb.png" title="In English" alt="In English"></a>
            <a href="http://codeforces.com/contest/145/problem/E?locale=ru"><img src="./Problem - E - Codeforces_files/ru.png" title="По-русски" alt="По-русски"></a>
        </div>
        <div>
                <a href="http://codeforces.com/profile/shibly">shibly</a>
                 | 
                <a href="http://codeforces.com/logout">Logout</a>
                
        </div>
    </div>
    <div style="font-size:0.8em;margin-top:0.25em;position:absolute;right:0;top:4.25em;">
    </div>
    <br style="clear: both;">
</div>

    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
            <div class="menu-list-container">

<ul class="menu-list">
        <li class=""><a href="http://codeforces.com/">Home</a></li>
        <li class="current"><a href="http://codeforces.com/contests">Contests</a></li>
        <li class=""><a href="http://codeforces.com/gyms">Gym</a></li>
        <li class=""><a href="http://codeforces.com/problemset">Problemset</a></li>
        <li class=""><a href="http://codeforces.com/ratings">Rating</a></li>
        <li><span style="font-weight:bold;position:relative;bottom:0.5em;">|</span></li>
        <li class=""><a href="http://codeforces.com/help">FAQ</a></li>
        <li class=""><a href="http://codeforces.com/vkcup2012">VK Cup 2012 <img class="icon" src="./Problem - E - Codeforces_files/cup.png"></a></li>
</ul>
                <form action="http://codeforces.com/search">
                    <input class="search" name="query" value="Search by tag...">
                <input type="hidden" name="_tta" value="375"></form>
                <br style="clear: both;">
            </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            $("input.search").focus(function() {
                var val = $(this).val();
                if (val.indexOf("...") > 0) {
                    $(this).val("");
                }
            });
        });
    </script>
        <br style="height:3em; clear: both;">
        <div style="position: relative;">
                <div id="sidebar">

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <table class="rtable">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;">Codeforces Round #104 (Div. 1)</th>
                </tr>
                    <tr>
                                <td class="left " colspan="1"><span class="contest-state-phase">Finished</span></td>
                    </tr>
                    <tr>
                                <td class="left  dark" colspan="1"><span class="contest-state-regular countdown" home="http://stat.codeforces.ru" noredirection="true" textbeforeredirect="" cdid="i1">Practice</span></td>
                    </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span class="contest-state-regular countdown" home="http://stat.codeforces.ru" noredirection="true" textbeforeredirect="" cdid="i2"><center>
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="CONTEST" data-entityid="145" data-size="24" src="./Problem - E - Codeforces_files/star_gray_24.png">
    </span>

    <script type="text/javascript">
        $(document).ready(function() {
            $("img.toggle-favourite").click(function() {
                var size = $(this).attr("data-size");

                if ($(this).hasClass("remove-favourite")) {
                    $(this).attr("src", "http://stat.codeforces.ru/images/icons/star_gray_" + size + ".png");
                    $(this).removeClass("remove-favourite");
                    $(this).addClass("add-favourite");
                } else {
                    $(this).attr("src", "http://stat.codeforces.ru/images/icons/star_yellow_" + size + ".png");
                    $(this).removeClass("add-favourite");
                    $(this).addClass("remove-favourite");
                }

                var isFavourite = $(this).hasClass("remove-favourite");
                var type = $(this).attr("data-type");
                var entityId = $(this).attr("data-entityId");

                $.post("/data/favourite",
                        { entityId: entityId, type: type, isFavourite: isFavourite },
                        function(response) {
                        }, "json"
                );

                return false;
            });
        });
    </script>
</center></span></td>
                    </tr>
            </tbody>
        </table>
    </div>


    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Practice
            <div class="top-links">
            </div>
        </div>
<div>
    <div style="margin:1em;font-size:0.8em;">
        You are registered for practice. You can solve problems unofficially. Results can be found in the contest status and in the bottom of standings.
    </div>
</div>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {
        });
    </script>

<style type="text/css">
    .submitForm .field {
        font-size: 11px;
        width: 3em !important;
        padding-right: 1em;
    }

    .submitForm input, .submitForm select {
        font-size: 11px;
        width: 17em;
    }
</style>
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Submit?
            <div class="top-links">
            </div>
        </div>
<div>
    <form method="post" action="" enctype="multipart/form-data" class="submitForm">
        <input type="hidden" name="action" value="submitSolutionFormSubmitted">
        <input type="hidden" name="submittedProblemIndex" value="E">
        <input type="hidden" name="source" value="">

        <table class="table-form" style="width:90%;">
            <tbody><tr>
                <td class="field">Language:</td>
                <td>
                    <select name="programTypeId">
                        <option value="1" selected="true">GNU C++ 4.6</option>
                        <option value="2">Microsoft Visual C++ 2005+</option>
                        <option value="3">Delphi 7</option>
                        <option value="4">Free Pascal 2</option>
                        <option value="5">Java 6</option>
                        <option value="6">PHP 5.2+</option>
                        <option value="7">Python 2.6+</option>
                        <option value="8">Ruby 1.7+</option>
                        <option value="9">C# Mono 2.6+</option>
                        <option value="10">GNU C 4</option>
                        <option value="12">Haskell GHC 6.12</option>
                        <option value="13">Perl 5.12+</option>
                        <option value="16">GNU C++0x 4</option>
                        <option value="19">OCaml 3.12</option>
                        <option value="20">Scala 2.9</option>
                    </select>
                </td>
            </tr>

            <tr>
                <td class="field">Choose file:</td>
                <td>
                    <input name="sourceFile" type="file" value="">
                </td>
            </tr>

            <tr>
                <td colspan="2">
                    <div style="text-align: center;">
                        <input style="width:10em;" class="submit" type="submit" value="Submit">
                    </div>
                </td>
            </tr>
        </tbody></table>
    <input type="hidden" name="_tta" value="375"></form>
</div>
    </div>

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Problem tags
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Heaps, binary search trees, segment trees, hash tables, etc">
    data structures
            <img value="data structures" src="./Problem - E - Codeforces_files/close-10x10.png" style="position:relative;bottom:-1px;left:1px;cursor:pointer;">
</span>
    </div>
    <div style="clear:both;text-align:right;font-size:11px;">
            <label id="addTagLabel" style="display:none;">
                Add&nbsp;tag:
                <select problemid="839" id="addTagSelect">
                    <option value=""></option>
                        <option value="2-sat" title="2-satisfiability">2-sat</option>
                        <option value="binary search" title="Binary search">binary search</option>
                        <option value="bitmasks" title="Bitmasks">bitmasks</option>
                        <option value="brute force" title="Brute force">brute force</option>
                        <option value="chinese remainder theorem" title="Сhinese remainder theorem">chinese remainder theorem</option>
                        <option value="combinatorics" title="Combinatorics">combinatorics</option>
                        <option value="constructive algorithms" title="Constructive algorithms">constructive algorithms</option>
                        <option value="dfs and similar" title="Dfs and similar">dfs and similar</option>
                        <option value="divide and conquer" title="Divide and Conquer">divide and conquer</option>
                        <option value="dp" title="Dynamic programming">dp</option>
                        <option value="dsu" title="Disjoint set union">dsu</option>
                        <option value="expression parsing" title="Parsing expression grammar">expression parsing</option>
                        <option value="fft" title="Fast Fourier transform">fft</option>
                        <option value="flows" title="Graph network flows">flows</option>
                        <option value="games" title="Games, Sprague–Grundy theorem">games</option>
                        <option value="geometry" title="Geometry, computational geometry">geometry</option>
                        <option value="graph matchings" title="Graph matchings, König&#39;s theorem, vertex cover of bipartite graph">graph matchings</option>
                        <option value="graphs" title="Graphs">graphs</option>
                        <option value="greedy" title="Greedy algorithms">greedy</option>
                        <option value="hashing" title="Hashing, hashtables">hashing</option>
                        <option value="implementation" title="Implementation problems, programming technics, simulation">implementation</option>
                        <option value="math" title="Mathematics including integration, differential equations, etc">math</option>
                        <option value="matrices" title="Matrix multiplication, determinant, Cramer&#39;s rule, systems of linear equations">matrices</option>
                        <option value="meet-in-the-middle" title="Meet-in-the-middle">meet-in-the-middle</option>
                        <option value="number theory" title="Number theory: Euler function, GCD, divisibility, etc">number theory</option>
                        <option value="probabilities" title="Probabilities, expected values, statistics, random variables, etc">probabilities</option>
                        <option value="schedules" title="Scheduling Algorithms">schedules</option>
                        <option value="shortest paths" title="Shortest paths on weighted and unweighted graphs">shortest paths</option>
                        <option value="sortings" title="Sortings, orderings">sortings</option>
                        <option value="string suffix structeres" title="Suffix arrays, suffix trees, suffix automatas, etc">string suffix structures</option>
                        <option value="strings" title="Prefix- and Z-functions, suffix structures, Knuth–Morris–Pratt algorithm, etc">strings</option>
                        <option value="ternary search" title="Ternary search">ternary search</option>
                        <option value="trees" title="Trees">trees</option>
                        <option value="two pointers" title="Two pointers">two pointers</option>
                </select>
            </label>
            <a id="addTagLink" href="http://codeforces.com/contest/145/problem/E#">Add&nbsp;tag</a>
    </div>
</div>
    </div>

<form id="addTagForm" action="http://codeforces.com/data/problemTags" method="post" style="display:none;">
    <input name="action" type="hidden" value="addTag">
    <input name="problemId" type="hidden" value="839">
    <input name="tagName" type="hidden" value="">
<input type="hidden" name="_tta" value="375"></form>

<form id="removeTagForm" action="http://codeforces.com/data/problemTags" method="post" style="display:none;">
    <input name="action" type="hidden" value="removeTag">
    <input name="problemId" type="hidden" value="839">
    <input name="tagName" type="hidden" value="">
<input type="hidden" name="_tta" value="375"></form>

<script type="text/javascript">
    $(".tag-box img").click(function () {
        var tagName = $(this).attr("value");
        Codeforces.confirm("Are you sure you want to remove this tag?", function () {
            $("#removeTagForm input[name=tagName]").val(tagName);
            $("#removeTagForm").submit();
        }, function () {
        }, "Yes", "No");
    });

    $("#addTagLink").click(function () {
        $(this).hide();
        $("#addTagLabel").show();
        return false;
    });

    $("#addTagSelect").change(function () {
        var tagName = $(this).val();
        if (tagName === "") {
            $("#addTagLabel").hide();
            $("#addTagLink").show();
        } else {
            $("#addTagForm input[name=tagName]").val(tagName);
            $("#addTagForm").submit();
        }
    });
</script>
                </div>
                <div id="content" class="content-with-sidebar">
                <div class="second-level-menu">
<ul class="second-level-menu-list">
    <li class="current"><a href="http://codeforces.com/contest/145">Problems</a></li>
    <li><a href="http://codeforces.com/contest/145/submit">Submit</a></li>
    <li><a href="http://codeforces.com/contest/145/my">My submissions</a></li>
    <li><a href="http://codeforces.com/contest/145/status">Status</a></li>
    <li><a href="http://codeforces.com/contest/145/hacks">Hacks</a></li>
    <li><a href="http://codeforces.com/contest/145/room/0">Room</a></li>
    <li><a href="http://codeforces.com/contest/145/standings" target="blank">Standings</a></li>
    <li><a href="http://codeforces.com/contest/145/customtest">Custom test</a></li>
<li class="back" style="left: 0px; width: 91px; overflow-x: hidden; overflow-y: hidden; "><div class="left"></div></li></ul>
</div>

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Lucky Queries</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits <span class="tex-font-style-bf">4</span> and <span class="tex-font-style-bf">7</span>. For example, numbers <span class="tex-font-style-bf">47</span>, <span class="tex-font-style-bf">744</span>, <span class="tex-font-style-bf">4</span> are lucky and <span class="tex-font-style-bf">5</span>, <span class="tex-font-style-bf">17</span>, <span class="tex-font-style-bf">467</span> are not.</span></p><p>Petya brought home string <span class="tex-span"><i>s</i></span> with the length of <span class="tex-span"><i>n</i></span>. The string only consists of lucky digits. The digits are numbered from the left to the right starting with <span class="tex-span">1</span>. Now Petya should execute <span class="tex-span"><i>m</i></span> queries of the following form:</p><p></p><ul> <li> <span class="tex-font-style-it">switch <span class="tex-span"><i>l</i></span> <span class="tex-span"><i>r</i></span></span> — "switch" digits (i.e. replace them with their opposites) at all positions with indexes from <span class="tex-span"><i>l</i></span> to <span class="tex-span"><i>r</i></span>, inclusive: each digit <span class="tex-span">4</span> is replaced with <span class="tex-span">7</span> and each digit <span class="tex-span">7</span> is replaced with <span class="tex-span">4</span> <span class="tex-span">(1 ≤ <i>l</i> ≤ <i>r</i> ≤ <i>n</i>)</span>; </li><li> <span class="tex-font-style-it">count</span> — find and print on the screen the length of the longest non-decreasing subsequence of string <span class="tex-span"><i>s</i></span>. </li></ul><p></p><p>Subsequence of a string <span class="tex-span"><i>s</i></span> is a string that can be obtained from <span class="tex-span"><i>s</i></span> by removing zero or more of its elements. A string is called non-decreasing if each successive digit is not less than the previous one.</p><p>Help Petya process the requests.</p></div><p< p=""><p< p=""><div class="input-specification"><div class="section-title">Input</div><p< p=""><p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">6</sup>, 1 ≤ <i>m</i> ≤ 3·10<sup class="upper-index">5</sup></span>) — the length of the string <span class="tex-span"><i>s</i></span> and the number of queries correspondingly. The second line contains <span class="tex-span"><i>n</i></span> lucky digits without spaces — Petya's initial string. Next <span class="tex-span"><i>m</i></span> lines contain queries in the form described in the statement.</p></p<></div><p< p=""><p< p=""><div class="output-specification"><div class="section-title">Output</div><p< p=""><p>For each query <span class="tex-font-style-it">count</span> print an answer on a single line.</p></p<></div><p< p=""><p< p=""><div class="sample-tests"><div class="section-title">Sample test(s)</div><p< p=""><p< p=""><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 3<br>47<br>count<br>switch 1 2<br>count<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br>1<br></pre></div><div class="input"><div class="title">Input</div><pre>3 5<br>747<br>count<br>switch 1 1<br>count<br>switch 1 3<br>count<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br>3<br>2<br></pre></div></div></p<></p<></div><p< p=""><p< p=""><div class="note"><div class="section-title">Note</div><p< p=""><p>In the first sample the chronology of string <span class="tex-span"><i>s</i></span> after some operations are fulfilled is as follows (the sought maximum subsequence is marked with <span class="tex-font-style-bf">bold</span>): </p><ol> <li> <span class="tex-font-style-bf">47</span> </li><li> 74 </li><li> <span class="tex-font-style-bf">7</span>4 </li></ol> In the second sample: <ol> <li> 7<span class="tex-font-style-bf">47</span> </li><li> 447 </li><li> <span class="tex-font-style-bf">447</span> </li><li> 774 </li><li> <span class="tex-font-style-bf">77</span>4 </li></ol><p></p></p<></div></p<></p<></p<></p<></p<></p<></p<></p<></div><p> </p></div>            </div>
        </div>
          <br style="clear:both;"> 
          <div id="footer">
               <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2012 Mike Mirzayanov</div>
               <div>The only programming contests Web 2.0 platform</div>
               
               <div>Server time: 03/01/2012 07:43PM.</div>
          </div>
    <script type="text/javascript">
        $(document).ready(function() {
            Codeforces.focusOnError();
        });
    </script>
</div>    
                                       
                                       
<div id="datepick-div" style="display: none;"></div></body></html>